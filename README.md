# Spectral Subtraction (스펙트럼 감산)

Spectral Subtraction은 신호 처리 분야에서 잡음 제거(noise reduction)를 위한 대표적인 기법으로, 주로 음성 신호 처리에서 사용됩니다. 이 기법은 시간-주파수 영역에서 신호와 잡음을 분리하는 데 초점이 맞춰져 있습니다.
- 디폴트로는 **Whisper 모델**을 사용할 수 있습니다.
- **StarHuBERT**:
  - 비교적 적은 파라미터를 사용하면서도 좋은 성능을 제공.
  - 온디바이스(On-Device) 환경에서 특히 적합한 성능을 발휘합니다.

## 참조 논문
- StarHuBERT에 관한 자세한 내용은 [논문](https://arxiv.org/pdf/2312.09040)을 참조하세요.


---
## 사용 데이터 셋 
- 극한소음데이터 -aihub링크(https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=data&dataSetSn=71417)
---
## 기본 원리

1. **신호 모델**:
   - 잡음이 추가된 신호는 다음과 같이 모델링됩니다:
     \[
     Y(f) = S(f) + N(f)
     \]
     - \(Y(f)\): 관측 신호
     - \(S(f)\): 원래 신호(목표)
     - \(N(f)\): 잡음

2. **잡음 스펙트럼 추정**:
   - 음성 없는 구간(배경 잡음만 있는 구간)에서 잡음의 스펙트럼을 추정합니다.

3. **스펙트럼 감산**:
   - 관측 신호의 스펙트럼에서 잡음 스펙트럼을 감산하여 원래 신호를 추정합니다:
     \[
     |S(f)|^2 = |Y(f)|^2 - |N(f)|^2
     \]
     - \(|\cdot|\): 신호의 크기(magnitude)

4. **신호 복원**:
   - 감산된 결과를 이용해 역변환(Inverse Fourier Transform)을 수행하여 시간 영역 신호로 복원합니다.

---

## 장점

- **단순성**: 구현이 간단하며 계산 비용이 낮아 실시간 처리에 적합합니다.
- **효율성**: 배경 잡음을 효과적으로 제거할 수 있습니다.

---

## 단점 및 한계

1. **음질 저하**:
   - 과도한 감산은 "뮤지컬 노이즈(musical noise)"와 같은 신호 왜곡을 초래할 수 있습니다.
2. **잡음 추정 의존**:
   - 잡음 특성을 정확히 추정하지 못하면 원래 신호도 손상될 가능성이 있습니다.
3. **비정상 잡음 처리**:
   - 시간적으로 변하는 잡음에서는 성능이 떨어질 수 있습니다.

---

## 주요 응용 분야

- 음성 통신(VoIP)
- 음성 인식 시스템
- 보청기
- 오디오 복원


